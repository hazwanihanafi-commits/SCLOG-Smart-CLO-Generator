<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SCLOG — Smart CLO Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{background:#f5f3ff;font-family:system-ui}
.card-box{background:#fff;border-radius:14px;padding:16px;border:1px solid #e5e7eb}
.step-header{font-weight:800;color:#4c1d95}
.step-desc{font-size:.9rem;color:#6b7280}
.logic-box{background:#f7f2ff;border-radius:10px;padding:12px}
.badge-vbe{background:#ede9fe;color:#6d28d9;font-weight:700}
.bloom-tag{font-size:.7rem;font-weight:900;background:#ede9fe;color:#6d28d9;padding:4px 8px;border-radius:999px}
small.muted{color:#6b7280}
</style>
</head>

<body>
<div class="container my-4">

<!-- HEADER -->
<div class="card-box mb-3">
  <h3 style="color:#6d28d9;font-weight:900">SCLOG</h3>
  <div class="text-muted">
    Smart Course Learning Outcome Generator (MQA • OBE • VBE)
  </div>
</div>

<!-- =====================================================
PROGRAMME DESIGN
===================================================== -->
<div class="card-box mb-4">

  <div class="step-header">Programme Design</div>
  <div class="step-desc">
    Define Institutional Educational Goal (IEG), then generate Programme
    Educational Objectives (PEO) aligned with programme level, discipline,
    and Values-Based Education (VBE).
  </div>

  <hr>

  <!-- IEG -->
  <label class="form-label">Institutional Educational Goal (IEG)</label>
  <textarea id="iegText" class="form-control mb-3"
    placeholder="Paste your IEG here (optional)"></textarea>

  <!-- Level + Discipline -->
  <div class="row g-3">
    <div class="col-md-4">
      <label class="form-label">Programme Level</label>
      <select id="level" class="form-select">
        <option value="">Select level</option>
        <option>Diploma</option>
        <option>Degree</option>
        <option>Master</option>
        <option>PhD</option>
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label">Discipline</label>
      <select id="discipline" class="form-select">
        <option value="">Select discipline</option>
        <option value="computing">Computing</option>
        <option value="engineering">Engineering</option>
        <option value="health">Medical & Health</option>
        <option value="education">Education</option>
        <option value="business">Business</option>
        <option value="social">Social Sciences</option>
        <option value="arts">Arts & Humanities</option>
      </select>
    </div>

    <div class="col-md-4 d-flex align-items-end">
      <button id="generatePEO" class="btn btn-primary w-100">
        Generate PEOs
      </button>
    </div>
  </div>

  <!-- PEO OUTPUT -->
  <div id="peoContainer" class="mt-4"></div>

</div>

<!-- =====================================================
CLO BUILDER
===================================================== -->
<div class="card-box">

  <div class="d-flex align-items-center gap-2">
    <h5 class="mb-0">Smart CLO Builder</h5>
    <span id="bloomTag" class="bloom-tag">—</span>
  </div>

  <div class="step-desc mt-1">
    Construct Course Learning Outcomes (CLO) aligned with selected PLO,
    Bloom’s Taxonomy, and VBE.
  </div>

  <div class="row g-3 mt-3">
    <div class="col-md-4">
      <label class="form-label">PLO</label>
      <select id="plo" class="form-select"></select>
    </div>

    <div class="col-md-4">
      <label class="form-label">Bloom Level</label>
      <select id="bloom" class="form-select"></select>
      <small class="muted" id="bloomWhy"></small>
    </div>

    <div class="col-md-4">
      <label class="form-label">Verb</label>
      <select id="verb" class="form-select"></select>
    </div>

    <div class="col-12">
      <label class="form-label">Content / Learning Focus</label>
      <input id="content" class="form-control"
        placeholder="e.g. ECG waveform interpretation">
    </div>

    <div class="col-12">
      <button id="generateCLO" class="btn btn-success">
        Generate CLO
      </button>
    </div>

    <div id="cloBox" class="col-12 mt-3" style="display:none">
      <div class="logic-box">
        <strong>CLO:</strong>
        <div id="cloText"></div>
      </div>
    </div>
  </div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* =====================================================
DATA MODELS (VBE-AWARE)
===================================================== */
const VBE_BY_LEVEL = {
  Diploma: {
    verbs:["demonstrate","apply","practice"],
    values:["Responsibility","Discipline","Respect"],
    focus:"work readiness and ethical conduct"
  },
  Degree: {
    verbs:["apply","analyze","evaluate"],
    values:["Integrity","Justice","Dignity"],
    focus:"professional practice and societal responsibility"
  },
  Master: {
    verbs:["evaluate","integrate","lead"],
    values:["Integrity","Wisdom","Accountability"],
    focus:"advanced decision-making and leadership"
  },
  PhD: {
    verbs:["create","innovate","advance"],
    values:["Truth","Integrity","Global Responsibility"],
    focus:"knowledge creation and ethical leadership"
  }
};

const DISCIPLINE_CONTEXT = {
  computing:"ethical and innovative computing practice",
  engineering:"safe and sustainable engineering solutions",
  health:"patient-centred healthcare practice",
  education:"learner development and pedagogy",
  business:"organizational leadership and sustainability",
  social:"societal development and wellbeing",
  arts:"cultural expression and human values"
};

/* =====================================================
UTILS
===================================================== */
const $ = id => document.getElementById(id);

/* =====================================================
GENERATE PEOs
===================================================== */
function generatePEOs() {
  const level = $("level").value;
  const discipline = $("discipline").value;
  const ieg = $("iegText").value || "the Institutional Educational Goal";

  if (!level || !discipline) {
    alert("Please select programme level and discipline.");
    return;
  }

  const cfg = VBE_BY_LEVEL[level];
  const ctx = DISCIPLINE_CONTEXT[discipline];
  const box = $("peoContainer");
  box.innerHTML = "";

  for (let i=1;i<=5;i++){
    const verb = cfg.verbs[(i-1)%cfg.verbs.length];
    const value = cfg.values[(i-1)%cfg.values.length];

    box.innerHTML += `
      <div class="logic-box mb-3">
        <strong>PEO${i}</strong>
        <div class="mt-1">
          Produce graduates who ${verb} professional competence in
          ${ctx}, guided by <span class="badge badge-vbe">${value}</span>,
          in alignment with ${ieg}.
        </div>

        <div class="mt-2">
          <strong>Mapped PLOs:</strong>
          ✔ PLO1 ✔ PLO2 ✔ PLO3
        </div>

        <div class="mt-2">
          <strong>Programme Performance Indicators:</strong>
          <ul>
            <li>Graduate employment / role relevance</li>
            <li>Employer satisfaction survey</li>
            <li>Alumni self-assessment of competence</li>
          </ul>
        </div>

        <small class="muted">
          This PEO operationalises the IEG at ${level} level,
          emphasising ${value} as a core VBE principle.
        </small>
      </div>
    `;
  }
}

$("generatePEO").addEventListener("click", generatePEOs);

/* =====================================================
CLO FLOW (BACKEND-CONNECTED)
===================================================== */
$("plo").addEventListener("change", async()=>{
  const pl = $("plo").value;
  if(!pl) return;
  $("bloom").innerHTML = `<option value="">Select Bloom</option>`;
  const blooms = await fetch(`/api/get_blooms/${pl}`).then(r=>r.json());
  blooms.forEach(b=>$("bloom").add(new Option(b,b)));
});

$("bloom").addEventListener("change", async()=>{
  const pl = $("plo").value;
  const bl = $("bloom").value;
  if(!pl || !bl) return;

  $("bloomWhy").textContent =
    `This Bloom level is appropriate for assessing the cognitive depth of ${pl}.`;

  $("verb").innerHTML = `<option value="">Select Verb</option>`;
  const verbs = await fetch(`/api/get_verbs/${pl}/${bl}`).then(r=>r.json());
  verbs.forEach(v=>$("verb").add(new Option(v,v)));
});

$("generateCLO").addEventListener("click", async()=>{
  const fd = new FormData();
  fd.append("plo",$("plo").value);
  fd.append("bloom",$("bloom").value);
  fd.append("verb",$("verb").value);
  fd.append("content",$("content").value);

  const data = await fetch("/generate",{method:"POST",body:fd})
    .then(r=>r.json());

  $("cloText").textContent = data.clo;
  $("cloBox").style.display="block";
});
</script>
</body>
</html>
